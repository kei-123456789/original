'use strict';
if(location.pathname === '/prefectures/2') {
  const lat2 = 43.046848;
  const long2 = 141.322114;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/3') {
  const lat2 = 40.7831;
  const long2 = 140.8283;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/4') {
  const lat2 = 39.7525;
  const long2 = 140.4054;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/5') {
  const lat2 = 39.596;
  const long2 = 141.3597;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/6') {
  const lat2 = 38.4503;
  const long2 = 140.0997;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/7') {
  const lat2 = 38.4494;
  const long2 = 140.9262;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/8') {
  const lat2 = 37.75;
  const long2 = 140.4678;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/9') {
  const lat2 = 36.5075;
  const long2 = 138.9823;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/10') {
  const lat2 = 36.6926;
  const long2 = 139.8161;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/11') {
  const lat2 = 36.3103;
  const long2 = 140.3161;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/12') {
  const lat2 = 35.8572;
  const long2 = 139.649;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/13') {
  const lat2 = 35.6051;
  const long2 = 140.1233;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/14') {
  const lat2 = 35.6895;
  const long2 = 139.6917;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/15') {
  const lat2 = 35.4175;
  const long2 = 139.3389;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/16') {
  const lat2 = 37.5234;
  const long2 = 138.9175;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/17') {
  const lat2 = 36.6393;
  const long2 = 137.2651;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/18') {
  const lat2 = 36.7715;
  const long2 = 136.7705;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/19') {
  const lat2 = 35.8501;
  const long2 = 136.2252;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/20') {
  const lat2 = 36.1346;
  const long2 = 138.0408;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/21') {
  const lat2 = 35.7809;
  const long2 = 137.054;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/22') {
  const lat2 = 35.616;
  const long2 = 138.608;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/23') {
  const lat2 = 35.1802;
  const long2 = 136.9066;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/24') {
  const lat2 = 35.0252;
  const long2 = 138.3254;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/25') {
  const lat2 = 35.2543;
  const long2 = 135.4412;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/26') {
  const lat2 = 35.2194;
  const long2 = 136.1365;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/27') {
  const lat2 = 34.6937;
  const long2 = 135.5022;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/28') {
  const lat2 = 34.6852;
  const long2 = 135.8329;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/29') {
  const lat2 = 34.5212;
  const long2 = 136.383;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/30') {
  const lat2 = 33.9146;
  const long2 = 135.5111;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/31') {
  const lat2 = 35.0403;
  const long2 = 134.826;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/32') {
  const lat2 = 35.3679;
  const long2 = 133.8508;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/33') {
  const lat2 = 34.902;
  const long2 = 133.8102;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/34') {
  const lat2 = 35.0769;
  const long2 = 132.5611;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/35') {
  const lat2 = 34.6067;
  const long2 = 132.7854;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/36') {
  const lat2 = 34.2061;
  const long2 = 131.5705;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/37') {
  const lat2 = 34.2472;
  const long2 = 133.9947;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/38') {
  const lat2 = 33.6285;
  const long2 = 132.8547;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/39') {
  const lat2 = 33.9218;
  const long2 = 134.2368;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/40') {
  const lat2 = 33.428;
  const long2 = 133.364;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/41') {
  const lat2 = 33.5281;
  const long2 = 130.6647;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/42') {
  const lat2 = 33.2493;
  const long2 = 130.2988;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/43') {
  const lat2 = 33.2334;
  const long2 = 129.6111;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/44') {
  const lat2 = 33.199;
  const long2 = 131.4335;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/45') {
  const lat2 = 32.6205;
  const long2 = 130.7543;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/46') {
  const lat2 = 32.1981;
  const long2 = 131.2976;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/47') {
  const lat2 = 31.0322;
  const long2 = 130.4329;
  ajaxRequest(lat2, long2);
} else if(location.pathname === '/prefectures/48') {
  const lat2 = 25.7722;
  const long2 = 126.6687;
  ajaxRequest(lat2, long2);
}

console.log('no');

// ajaxRequest(lat2, long2);

// UTCをミリ秒に
function utcToJSTime(utcTime) {
  return utcTime * 1000;
}

// データ取得
function ajaxRequest(lat, long) {
  const url = 'https://api.openweathermap.org/data/2.5/forecast';
  const appId = 'af04c9d9fbeeb75ac003c77f6b7f4018';

  $.ajax({
    url: url,
    data: {
      appid: appId,
      lat: lat,
      lon: long,
      units: 'metric',
      lang: 'ja'
    }
  })
  .done(function(data) {
    console.log(data);

    // 都市名、国名
    $('#place').text(data.city.name + ',' + data.city.country);

    // 天気予報データ
    data.list.forEach(function(forecast, index) {
      const dateTime = new Date(utcToJSTime(forecast.dt));
      const month = dateTime.getMonth() + 1;
      const date = dateTime.getDate();
      const hours = dateTime.getHours();
      const min = String(dateTime.getMinutes()).padStart(2, '0');
      const temperature = Math.round(forecast.main.temp);
      const description = forecast.weather[0].description;
      const iconPath = `/assets/${forecast.weather[0].icon}.svg`;

    // 現在の天気とそれ以外で出力を変える
    if(index === 0) {
      const currentWeather = `
      <div class="icon"><img src="${iconPath}"></div>
      <div class="info">
        <p>
          <span class="description">現在の天気:${description}</span>
          <span class="temp">${temperature}</span>°c
        </p>
      </div>`;
      $('#weather').html(currentWeather);
    } else {
      const tableRow = `
      <tr>
        <td class="info">
          ${month}/${date} ${hours}:${min}
        </td>
        <td class="icon"><img src="${iconPath}"></td>
        <td><span class="description">${description}</span></td>
        <td><span class="temp">${temperature}</span></td>
      </tr>`;
      $('#forecast').append(tableRow);
    }
    });
  })
  .fail(function() {
    console.log(`$.ajax failed!`);
  })
}